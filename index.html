<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ENSO • Builders & Pilots</title>
<link rel="icon" href="/images/pilot.png" type="image/x-icon" />

<!-- Inter font -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet" />

<style>
/* ===== Global font ===== */
html{
  font-family:"Inter",system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans",Arial,sans-serif;
  font-size:17px; line-height:1.45; -webkit-text-size-adjust:100%;
  text-rendering:optimizeLegibility; font-synthesis-weight:none;
}
:where(body, h1,h2,h3,h4,h5,h6, p, a, small, strong, em, ul, ol, li,
button, input, select, textarea, label, div, span){ font-family:inherit }
:where(pre, code, kbd, samp){ font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace }

/* ===== Theme tokens ===== */
:root{
  --radius-2xl:22px; --radius-xl:18px; --radius-lg:16px;
  --blue:#3B82F6; --blue-inner:rgba(59,130,246,.40);
  --gold:#FFC72C; --gold-outer:rgba(255,199,44,.65); --gold-inner:rgba(255,199,44,.40);
  --ink:#EAF2FF; --muted:#A8B2C0; --line:rgba(255,255,255,.18);
  --shadow:0 18px 60px rgba(0,0,0,.45); --blur:20px;
  --bg: radial-gradient(1200px 600px at 20% -10%, #0E1B35 0%, transparent 60%),
        radial-gradient(1200px 600px at 90% 10%, #1C1530 0%, transparent 55%),
        linear-gradient(135deg, #0B1422 0%, #121A30 55%, #1D1425 100%);
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0; color:var(--ink); background:transparent; position:relative; overflow-x:hidden}
body::before{content:""; position:fixed; inset:0; z-index:-1; background:var(--bg); background-attachment:fixed}
.page{max-width:1680px; margin:0 auto; padding:28px clamp(24px,7vw,84px)}

/* Glass utility */
.glass{background:rgba(255,255,255,.06); -webkit-backdrop-filter:blur(var(--blur)) saturate(160%); backdrop-filter:blur(var(--blur)) saturate(160%)}

/* ===== Topbar ===== */
.topbar{position:sticky; top:20px; z-index:50; border:2px solid var(--blue); border-radius:var(--radius-2xl); box-shadow:0 24px 70px rgba(0,0,0,.42), inset 0 0 0 1px var(--blue-inner)}
.topbar .wrap{display:flex; align-items:center; gap:16px; padding:12px 18px}
.brand img{height:28px}
.nav{margin-left:auto; display:flex; gap:12px; flex-wrap:wrap}
.nav a{
  color:var(--ink); text-decoration:none; font-weight:800; font-size:14px;
  padding:10px 14px; border-radius:999px; border:1px solid var(--line);
  background:rgba(255,255,255,.08); transition:.25s ease; will-change:transform, box-shadow, border-color
}
.nav a:hover{transform:translateY(-1px); border-color:rgba(255,255,255,.25); box-shadow:0 6px 18px rgba(0,0,0,.22)}
.nav a.accent-gold{ border-color:var(--gold); box-shadow:inset 0 0 0 1px var(--gold-inner); color:#FFD76A }
.nav a.accent-purple{ border-color:#A78BFA; box-shadow:inset 0 0 0 1px rgba(167,139,250,.35) }

/* ===== Hero ===== */
.hero{margin-top:18px; border:2px solid var(--blue); border-radius:var(--radius-2xl); box-shadow:var(--shadow), inset 0 0 0 1px var(--blue-inner)}
.hero .container{padding:46px 28px}
.hero h1{margin:0; font-size:clamp(40px,6.2vw,82px); font-weight:900; letter-spacing:-.02em}
.hero p{color:var(--muted); max-width:900px; font-size:18px; margin:12px 0 22px}
.hero .cta-row{display:flex; gap:12px; flex-wrap:wrap}
.button{display:inline-flex; align-items:center; gap:10px; font-weight:800; border:1px solid var(--line); color:var(--ink); text-decoration:none; padding:12px 14px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,.16), rgba(255,255,255,.08))}
.button.gold{border-color:var(--gold); color:#12140c; background:linear-gradient(180deg, rgba(255,199,44,.95), rgba(255,199,44,.75)); box-shadow:0 12px 28px rgba(255,199,44,.18)}

/* ===== Sections / reveal ===== */
.section{margin:36px 0; content-visibility:auto; contain-intrinsic-size:1px 600px}
.section .eyebrow{color:var(--muted); font-size:12px; letter-spacing:.14em; text-transform:uppercase; margin-bottom:10px}
.section h2{margin:0 0 10px; font-size:clamp(28px,4.4vw,52px); line-height:1.08; font-weight:900; letter-spacing:-.02em}
.section .lead{color:var(--muted); margin-bottom:18px}
.reveal{opacity:0; transform:translateY(18px); filter:saturate(90%); transition:opacity .7s cubic-bezier(.22,.61,.36,1), transform .7s cubic-bezier(.22,.61,.36,1), filter .7s}
.reveal.is-visible{opacity:1; transform:none; filter:none}

/* ===== Feature grid ===== */
.features{display:grid; grid-template-columns:repeat(5,1fr); gap:18px}
@media (max-width:1280px){.features{grid-template-columns:repeat(3,1fr)}}
@media (max-width:900px){.features{grid-template-columns:repeat(2,1fr)}}
@media (max-width:640px){.features{grid-template-columns:1fr}}
.feature{border:1px solid rgba(255,255,255,.18); border-radius:14px; padding:18px; background:rgba(255,255,255,.05); position:relative; overflow:hidden}
.feature .sub{color:var(--muted); font-weight:800; font-size:12px; letter-spacing:.14em; text-transform:uppercase; opacity:.85; margin-bottom:8px}
.feature h3{margin:0 0 8px; font-size:18px; font-weight:900; letter-spacing:-.01em}
.feature p{margin:0; color:var(--muted); font-size:14px; line-height:1.6}
.feature.gold{border-color:var(--gold); box-shadow:inset 0 0 0 1px var(--gold-inner), 0 0 22px rgba(255,199,44,.08)}
.feature::after{
  content:""; position:absolute; inset:-40%; background:radial-gradient(400px 220px at var(--mx,60%) var(--my,20%), rgba(255,255,255,.08), transparent 60%);
  pointer-events:none; transition:opacity .25s; opacity:0
}
.feature:hover::after{opacity:1}

/* ===== API cards ===== */
.api-grid{display:grid; grid-template-columns:repeat(3,1fr); gap:18px}
@media (max-width:1100px){.api-grid{grid-template-columns:repeat(2,1fr)}}
@media (max-width:700px){.api-grid{grid-template-columns:1fr}}
.api{border:1px solid rgba(59,130,246,.25); border-radius:14px; padding:18px; background:rgba(255,255,255,.05); transition:transform .25s ease, box-shadow .25s ease}
.api:hover{transform:translateY(-4px); box-shadow:0 16px 40px rgba(0,0,0,.24)}
.api h4{margin:0 0 10px; font-size:16px; font-weight:900; letter-spacing:-.01em}
.api p{margin:0 0 8px; color:var(--muted); font-size:14px}
.api pre{margin:10px 0 0; padding:12px; border-radius:10px; overflow:auto; background:rgba(0,0,0,.35); color:#EAF2FF; font-size:13px; border:1px solid rgba(255,255,255,.12)}

/* ===== Role boxes ===== */
.role-meta{display:flex; align-items:center; justify-content:space-between; color:var(--muted); font-size:12px; letter-spacing:.14em; text-transform:uppercase; margin:18px 0 10px}
.role-highlight{font-size:22px; font-weight:900; color:var(--gold); margin-top:4px}
.roles{display:grid; grid-template-columns:repeat(4,1fr); gap:18px}
@media (max-width:1100px){.roles{grid-template-columns:repeat(2,1fr)}}
@media (max-width:640px){.roles{grid-template-columns:1fr}}
.role-card{border:1px solid rgba(59,130,246,.25); border-radius:14px; padding:18px; background:rgba(255,255,255,.05); transition:transform .25s ease, box-shadow .25s ease}
.role-card:hover{transform:translateY(-4px); box-shadow:0 16px 40px rgba(0,0,0,.24)}
.role-card h4{margin:0 0 10px; font-size:16px; font-weight:900; letter-spacing:-.01em}
.role-card ul{margin:0; padding-left:20px}
.role-card li{margin:8px 0; color:var(--ink)}
.role-card li::marker{color:var(--gold); font-weight:900}

/* ===== Stats counters ===== */
.stats{display:grid; grid-template-columns:repeat(3,1fr); gap:16px; align-items:stretch;}
@media (max-width:1000px){.stats{grid-template-columns:repeat(2,1fr)}}
@media (max-width:560px){.stats{grid-template-columns:1fr}}
.stat{
  border:1px solid rgba(255,255,255,.16); border-radius:16px; padding:18px;
  background:rgba(255,255,255,.05); display:flex; flex-direction:column; justify-content:center; gap:10px;
  height:100%; min-height:160px;
}
.stat .count{font-size:clamp(26px,4.2vw,42px); font-weight:900; letter-spacing:-.02em; background:linear-gradient(90deg,#fff,#BEE3FF); -webkit-background-clip:text; -webkit-text-fill-color:transparent}
.stat .label{color:var(--muted); font-size:13px}
.stat-gold{border-color:var(--gold)!important; box-shadow:inset 0 0 0 1px var(--gold-inner), 0 0 18px rgba(255,199,44,.10)}
.stat-gold .count{background:linear-gradient(90deg,#FFD76A,#FFFFFF); -webkit-background-clip:text; -webkit-text-fill-color:transparent}
.flag-row{display:flex; gap:8px; flex-wrap:wrap; margin-top:2px}
.flag{width:28px; height:28px; display:grid; place-items:center; border-radius:50%;
  background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.18); font-size:16px; line-height:1}

/* ===== Marquee ===== */
.marquee{position:relative; overflow:hidden; border:1px solid rgba(255,255,255,.14); border-radius:16px; background:rgba(255,255,255,.05)}
.marquee::before,.marquee::after{
  content:""; position:absolute; top:0; bottom:0; width:80px; z-index:2;
  pointer-events:none; background:linear-gradient(to right, #0B1422 0%, rgba(11,20,34,0) 100%)
}
.marquee::after{right:0; transform:scaleX(-1)}
.track{display:flex; gap:18px; padding:16px 24px; width:max-content; animation:scroll 36s linear infinite}
@keyframes scroll{from{transform:translateX(0)} to{transform:translateX(-50%)}}
.chip{
  padding:10px 14px; border:1px solid rgba(255,255,255,.18); border-radius:999px;
  color:#EAF2FF; opacity:.9; white-space:nowrap; font-weight:800; letter-spacing:.02em; background:rgba(255,255,255,.06);
  display:flex; align-items:center; gap:8px;
}
.chip .emoji{font-size:18px; line-height:1}

/* ===== “Video from enso.build” (embedded) ===== */
.scrub{min-height:60vh; position:relative}
.scrub-sticky{position:sticky; top:8vh; height:72vh; border:1px solid rgba(255,255,255,.14); border-radius:18px; overflow:hidden; background:#0B1422; display:flex; align-items:stretch}
.scrub iframe, .scrub video{width:100%; height:100%; border:0; display:block; object-fit:cover}
.scrub .fallback{
  position:absolute; inset:auto 16px 16px auto; z-index:3;
  padding:10px 12px; border-radius:10px; font-weight:800; background:rgba(0,0,0,.48);
  border:1px solid rgba(255,255,255,.18); color:#fff; text-decoration:none
}
.scrub .caption{position:absolute; left:18px; bottom:18px; padding:10px 12px; border-radius:10px; font-weight:800; background:rgba(0,0,0,.35); border:1px solid rgba(255,255,255,.15)}

/* ===== Pilots grid (gold cards) ===== */
.grid{display:grid; grid-template-columns:repeat(3,minmax(0,1fr)); gap:18px}
@media (max-width:1200px){.grid{grid-template-columns:repeat(2,1fr)}}
@media (max-width:720px){.grid{grid-template-columns:1fr}}
.card{position:relative; border:2px solid var(--gold); border-radius:var(--radius-xl); overflow:hidden; box-shadow:var(--shadow), inset 0 0 0 1px var(--gold-inner); transition:transform .25s ease, box-shadow .25s ease}
.card:hover{transform:translateY(-4px); box-shadow:0 0 0 2px var(--gold) inset, 0 0 26px var(--gold-outer), 0 20px 50px rgba(0,0,0,.30)}
.card-header{position:relative; z-index:2; padding:14px 18px; display:flex; align-items:center; gap:16px; border-bottom:1px solid var(--line); cursor:pointer}
.badge{width:44px; height:44px; border-radius:50%; display:grid; place-items:center; background:rgba(255,255,255,.10); color:#E6F3FF; font-weight:900; box-shadow:inset 0 0 0 2px rgba(255,255,255,.18), 0 6px 16px rgba(0,0,0,.35)}
.media{position:relative; width:92px; height:92px; flex:0 0 92px}
.avatar{width:100%; height:100%; border-radius:50%; border:2px solid var(--gold); outline:1px solid var(--gold-inner); object-fit:cover; background:#0B0F1A; box-shadow:0 8px 18px rgba(255,199,44,.35)}
.helmet{position:absolute; right:-6px; bottom:-6px; width:40px; height:40px; filter:drop-shadow(0 2px 6px rgba(0,0,0,.18))}
.info h3{font-size:22px; margin:0 0 2px; font-weight:900; letter-spacing:-.01em}
.info .role{color:var(--muted); font-size:13px}
.card-info{padding:12px 18px 0; color:var(--muted); font-size:14px}
.pills{display:flex; flex-wrap:wrap; gap:8px; margin-top:8px}
.pill{border:1px solid var(--line); background:rgba(255,255,255,.10); padding:6px 10px; border-radius:999px; font-size:12px; color:var(--ink)}
.pill-pilot{border-color:var(--gold); color:#FFD76A; background:rgba(255,199,44,.12); box-shadow:inset 0 0 0 1px var(--gold-inner)}
.card-body{padding:14px 18px 18px; display:flex; gap:10px}
.btn{flex:1; display:flex; align-items:center; justify-content:center; gap:8px; border:1px solid var(--line); padding:10px 12px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,.16), rgba(255,255,255,.08)); color:var(--ink); text-decoration:none; font-size:15px; font-weight:800}

/* Footer */
.footer{border-top:1px solid var(--line); color:var(--muted); font-size:14px; margin-top:18px}
.footer .container{padding:18px 0}

/* Fireworks overlay */
.fireworks-canvas{position:absolute; inset:0; z-index:3; pointer-events:none; background:transparent}

/* Reduced motion */
@media (prefers-reduced-motion:reduce){
  .reveal{transition:none} .feature::after{display:none}
  .api,.role-card,.card,.nav a{transition:none}
  .scrub-sticky{position:relative; height:auto}
}
</style>
</head>
<body>
<div class="page">

  <!-- Topbar -->
  <header class="topbar glass reveal">
    <div class="wrap">
      <a class="brand" href="#home"><img src="https://framerusercontent.com/images/FPnvhl6ocJ58PYgLaYri68xb6cQ.webp" alt="Enso Logo"></a>
      <nav class="nav">
        <a href="#why">Why Enso</a>
        <a href="#build">Shortcuts</a>
        <a href="#roles">Roles</a>
        <a class="accent-gold" href="#pilots">Pilots</a>
        <a href="https://docs.enso.build/" target="_blank" rel="noreferrer noopener">Docs</a>
        <a class="accent-purple" href="https://speedrun.enso.build/" target="_blank" rel="noreferrer noopener">Speedrun</a>
      </nav>
    </div>
  </header>

  <!-- Hero -->
  <section id="home" class="hero glass reveal">
    <div class="container">
      <h1>ENSO global community</h1>
      <p>Enso is the fastest way to build and launch onchain — a shared engine that maps every onchain interaction. Focus on product, community, and growth.</p>
      <div class="cta-row">
        <a class="button gold" href="https://www.enso.build/" target="_blank" rel="noreferrer noopener">Start with Enso</a>
        <a class="button" href="https://docs.enso.build/" target="_blank" rel="noreferrer noopener">Read the Docs</a>
        <a class="button" href="https://x.com/EnsoBuild" target="_blank" rel="noreferrer noopener">Follow @EnsoBuild</a>
      </div>
    </div>
  </section>

  <!-- Feature / Roles Top -->
  <section id="why" class="section reveal">
    <div class="eyebrow">ROLE OVERVIEW</div>
    <h2>Empowering the Enso Role System.</h2>
    <div class="role-highlight">@Pilot — Highest Rank</div>

    <div class="features">
      <article class="feature glass"><div class="sub">GENERAL</div><h3>Censorship–Resistant</h3><p>Community identity that can’t be selectively silenced—recognition is earned by participation and stays visible.</p></article>
      <article class="feature glass"><div class="sub">SPEEDRUN</div><h3>Coordinated by Intents</h3><p>Progression is driven by mission “intents”—complete races/challenges to move up the ladder quickly and transparently.</p></article>
      <article class="feature glass"><div class="sub">DRIP</div><h3>Permissionless</h3><p>Anyone can contribute signal and outreach; perks acknowledge impact without gatekeepers.</p></article>
      <article class="feature glass"><div class="sub">RANKS</div><h3>Immutable</h3><p>A stable rank ladder for operations. Milestones don’t change retroactively and culminate at the top rank.</p></article>
      <article class="feature glass gold"><div class="sub">SPOTLIGHT</div><h3>@Pilot — Highest Rank</h3><p>The pinnacle of the Enso Role System—earned by consistent contributions, mastery, and community leadership.</p></article>
    </div>
  </section>

  <!-- COMMUNITY STATS -->
  <section id="stats" class="section reveal">
    <div class="eyebrow">COMMUNITY STATS</div>
    <h2>Growing a global, censorship-resistant community.</h2>
    <div class="stats">
      <div class="stat">
        <div class="count" data-count="10" data-suffix="+">0</div>
        <div class="label">Global community (countries)</div>
        <div class="flag-row" aria-label="Thailand, Indonesia, Malaysia, Nigeria, India, Ukraine, Russia, Switzerland">
          <span class="flag" title="Thailand">🇹🇭</span>
          <span class="flag" title="Indonesia">🇮🇩</span>
          <span class="flag" title="Malaysia">🇲🇾</span>
          <span class="flag" title="Nigeria">🇳🇬</span>
          <span class="flag" title="India">🇮🇳</span>
          <span class="flag" title="Ukraine">🇺🇦</span>
          <span class="flag" title="Russia">🇷🇺</span>
          <span class="flag" title="Switzerland">🇨🇭</span>
        </div>
      </div>
      <div class="stat">
        <div class="count" data-count="100000" data-suffix="+">0</div>
        <div class="label">Community</div>
      </div>
      <div class="stat stat-gold">
        <div class="count" id="pilotCount" data-count="80" data-suffix="+">0</div>
        <div class="label">Community Pilots</div>
      </div>
    </div>
  </section>

  <!-- Global community marquee (flags) -->
  <section id="ecosystem" class="section reveal">
    <div class="eyebrow">GLOBAL COMMUNITY</div>
    <h2>Countries represented by our community.</h2>
    <div class="marquee glass" aria-label="Global community flags marquee">
      <div class="track" id="marqueeTrack">
        <span class="chip"><span class="emoji">🇹🇭</span> Thailand</span>
        <span class="chip"><span class="emoji">🇮🇩</span> Indonesia</span>
        <span class="chip"><span class="emoji">🇲🇾</span> Malaysia</span>
        <span class="chip"><span class="emoji">🇳🇬</span> Nigeria</span>
        <span class="chip"><span class="emoji">🇮🇳</span> India</span>
        <span class="chip"><span class="emoji">🇺🇦</span> Ukraine</span>
        <span class="chip"><span class="emoji">🇷🇺</span> Russia</span>
        <span class="chip"><span class="emoji">🇨🇭</span> Switzerland</span>
      </div>
    </div>
  </section>

  <!-- Build with Shortcuts -->
  <section id="build" class="section reveal">
    <div class="eyebrow">BUILD WITH SHORTCUTS</div>
    <h2>Unified onchain engine. Two powerful APIs.</h2>
    <p class="lead">Route complex paths or bundle actions into one flow. Add onchain features with templates, not boilerplate.</p>

    <div class="api-grid">
      <article class="api glass">
        <h4>Automated Routing API</h4>
        <p>Calculate optimized multi-step paths between positions or tokens.</p>
<pre>POST /shortcuts/route
{
  "from": {"chain":"ethereum","asset":"USDC"},
  "to":   {"chain":"ethereum","asset":"wstETH"},
  "amount":"1000"
}</pre>
      </article>

      <article class="api glass">
        <h4>Bundling API</h4>
        <p>Compose your own multi-step workflow and ship it as a single Shortcut.</p>
<pre>POST /shortcuts/bundle
{
  "actions":[
    {"swap":{"from":"USDC","to":"ETH"}},
    {"stake":{"protocol":"lido"}}
  ]
}</pre>
      </article>

      <article class="api glass">
        <h4>Plug-and-Play Templates</h4>
        <p>Drop-in React widgets and starter flows to go live fast.</p>
<pre>// Install widget
npm i @enso/widgets

// Use in your app
&lt;EnsoSwap from="USDC" to="ETH" /&gt;</pre>
      </article>
    </div>
  </section>

  <!-- DEMO: replaced with MP4 -->
  <section id="demo" class="section reveal">
    <div class="eyebrow">SEE IT IN MOTION</div>
    <h2>The best execution.</h2>
    <p class="lead">Powered by Enso Network.</p>
    <div class="scrub glass" aria-label="Demo video">
      <div class="scrub-sticky">
        <video src="https://framerusercontent.com/assets/GifwF0GC6kftxDgniF6lsk9E9wc.mp4"
               autoplay muted loop playsinline></video>
        <div class="caption">Live demo</div>
      </div>
    </div>
  </section>

  <!-- Role groups -->
  <section id="roles" class="section reveal">
    <div class="role-meta"><span>2025</span><span>ROLE GROUPS</span></div>
    <div class="roles">
      <article class="role-card glass"><h4>GENERAL</h4><ul><li>@Community — Verified community member</li><li>@OG Enso — Members before Apr 19, 2022</li><li>@Enso Booster — Thank you for boosting</li><li>@Game Master — You love Enso’s gaming events</li></ul></article>
      <article class="role-card glass"><h4>SPEEDRUN</h4><ul><li>@Neon Rookie</li><li>@Midnight Racer</li><li>@Supersonic Samurai</li><li>@Tokyo Drifter</li><li>@Nitro Sensei</li></ul></article>
      <article class="role-card glass"><h4>DRIP</h4><ul><li>@Raiders — Ready to spread the word</li><li>@Portal — Spend 350 Shortcats and cross the Portal</li><li>@Veteran — Thank you for your service</li></ul></article>
      <article class="role-card glass"><h4>RANKS</h4><ul><li>@Trainee</li><li>@Junior</li><li>@Pit Crew</li><li>@Mechanic</li><li>@Pilot — Highest Rank</li></ul></article>
    </div>
  </section>

  <!-- Pilots -->
  <section id="pilots" class="section reveal">
    <div class="eyebrow">ENSO GLOBAL PILOT</div>
    <div class="grid" id="grid"></div>
  </section>

  <footer class="footer reveal"><div class="container">© 2025 ENSO • Builders & Pilots • Thanks bc1pBITHERUMN ⚡✨</div></footer>
</div>

<script>
/* ===== Config / assets ===== */
const HELMET_ICON_SRC = "/images/pilot-helmet.png";

/* ===== Scroll reveal (keep for everything EXCEPT pilot cards) ===== */
const io = new IntersectionObserver((entries)=>{
  entries.forEach(e=>{
    if(e.isIntersecting){ e.target.classList.add('is-visible'); io.unobserve(e.target); }
  });
},{rootMargin:"-5% 0px -10% 0px", threshold:0.12});
document.querySelectorAll('.reveal').forEach(el=>io.observe(el));

/* ===== Feature parallax shimmer ===== */
document.querySelectorAll('.feature').forEach(card=>{
  card.addEventListener('pointermove', (e)=>{
    const r = card.getBoundingClientRect();
    const x = ((e.clientX - r.left) / r.width) * 100;
    const y = ((e.clientY - r.top)  / r.height)* 100;
    card.style.setProperty('--mx', x+'%'); card.style.setProperty('--my', y+'%');
  });
});

/* ===== Counters ===== */
function formatNumber(n){ return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","); }
function countUp(el, end, {duration=1500, prefix="", suffix=""}={}){
  const start = 0; const startTime = performance.now();
  function step(now){
    const t = Math.min(1, (now - startTime) / duration);
    const val = Math.floor(start + (end - start) * t);
    el.innerHTML = `${prefix}${formatNumber(val)}${suffix}`;
    if(t < 1) requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}
const counterIO = new IntersectionObserver((ents)=>{
  ents.forEach(ent=>{
    if(ent.isIntersecting){
      const el = ent.target;
      const end = +el.dataset.count || 0;
      const prefix = el.dataset.prefix || "";
      const suffix = el.dataset.suffix || "";
      countUp(el, end, {prefix, suffix});
      counterIO.unobserve(el);
    }
  });
},{threshold:0.6});
document.querySelectorAll('.count').forEach(el=>counterIO.observe(el));

/* ===== Flags marquee duplicate ===== */
(function(){
  const track = document.getElementById('marqueeTrack');
  if(track) track.parentNode.appendChild(track.cloneNode(true));
})();

/* ===== Initials avatar ===== */
function initialAvatar(name, size=144){
  const ch = (name?.trim()?.[0] || "?").toUpperCase();
  const pal = [["#3B82F6","#A78BFA"],["#22D3EE","#818CF8"],["#F472B6","#60A5FA"],["#34D399","#22D3EE"],["#F59E0B","#F472B6"],["#A855F7","#06B6D4"]];
  const idx = Math.abs([...name].reduce((a,c)=>a+c.charCodeAt(0),0)) % pal.length;
  const [c1,c2] = pal[idx];
  const svg =
`<svg xmlns='http://www.w3.org/2000/svg' width='${size}' height='${size}' viewBox='0 0 ${size} ${size}'>
  <defs>
    <linearGradient id='g' x1='0' y1='0' x2='1' y2='1'><stop offset='0%' stop-color='${c1}'/><stop offset='100%' stop-color='${c2}'/></linearGradient>
    <filter id="shadow" x="-50%" y="-50%" width="200%"><feDropShadow dx="0" dy="1" stdDeviation="2" flood-color="#000" flood-opacity="0.35"/></filter>
  </defs>
  <circle cx='${size/2}' cy='${size/2}' r='${size/2-3}' fill='url(#g)' filter='url(#shadow)'/>
  <text x='50%' y='54%' text-anchor='middle' font-family="Inter, system-ui" font-size='${size*0.48}' fill='#0B0F1A' font-weight='900' dominant-baseline='middle'>${ch}</text>
</svg>`;
  return "data:image/svg+xml;utf8," + encodeURIComponent(svg);
}

/* ===== Icons ===== */
function iconDiscord(){return `<svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M20.3 5.6a16 16 0 0 0-4-1.3l-.2.4a12 12 0 0 1 3.5 1.7c-1.6-.7-3.2-1.1-4.9-1.3a9.5 9.5 0 0 0-2.1 0c-1.7.2-3.3.6-4.9 1.3a12 12 0 0 1 3.5-1.7l-.2-.4a16 16 0 0 0-4 1.3C3.6 10 3 14 3.2 18c1.7 1.3 3.6 2.2 5.7 2.7l.5-1.2c-.8-.3-1.6-.6-2.3-1 .2-.2.5-.5.7-.7a12 12 0 0 0 8.7 0l.7.7c-.7.4-1.5.7-2.3 1l.5 1.2c2.1-.5 4-1.4 5.7-2.7.2-4-.4-8-2.8-12.4ZM9.6 15.5c-1 0-1.8-.9-1.8-2s.8-2 1.8-2 1.8.9 1.8 2-.8 2-1.8 2Z"/></svg>`}
function iconX(){return `<svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M18.9 2H21l-6.6 7.5L22 22h-6.8l-5.3-6.4L3.9 22H2l7.1-8.1L2 2h6.9l4.8 5.8L18.9 2Zm-2.4 18h1.3L7.7 4H6.4l10.1 16Z"/></svg>`}

/* ===== Fireworks for Pilot cards ===== */
function launchFireworks(card, x, y){
  const cvs=document.createElement('canvas'); cvs.className='fireworks-canvas'; card.appendChild(cvs);
  const dpr=Math.max(1,devicePixelRatio||1), r=card.getBoundingClientRect(), w=r.width, h=r.height;
  cvs.style.width=w+'px'; cvs.style.height=h+'px'; cvs.width=Math.floor(w*dpr); cvs.height=Math.floor(h*dpr);
  const ctx=cvs.getContext('2d'); ctx.scale(dpr,dpr); ctx.globalCompositeOperation='lighter';
  const bx=x-r.left, by=y-r.top, colors=['#7DD3FC','#A78BFA','#F472B6','#FFFFFF','#FFC94A']; const parts=[];
  for(let b=0;b<3;b++){ const ox=bx+(Math.random()*30-15), oy=by+(Math.random()*30-15);
    for(let i=0;i<115;i++){ const ang=Math.random()*Math.PI*2, sp=3.2+Math.random()*5.4;
      parts.push({x:ox,y:oy,px:ox,py:oy,vx:Math.cos(ang)*sp,vy:Math.sin(ang)*sp,life:900+Math.random()*700,age:0,size:2+Math.random()*3.2,color:colors[Math.floor(Math.random()*colors.length)],drag:0.992-Math.random()*0.015,grav:0.03+Math.random()*0.02,sparkle:Math.random()<0.45});
  }}
  let last=performance.now();
  function tick(now){
    const dt=now-last; last=now; ctx.clearRect(0,0,w,h); let alive=false;
    for(const p of parts){ p.age+=dt; if(p.age<p.life){ alive=true; p.px=p.x; p.py=p.y; p.vx*=p.drag; p.vy=p.vy*p.drag+p.grav; p.x+=p.vx; p.y+=p.vy;
      const a=Math.max(0,1-p.age/p.life); ctx.strokeStyle=p.color; ctx.fillStyle=p.color; ctx.globalAlpha=Math.max(a,.22);
      ctx.lineWidth=p.size*.55; ctx.beginPath(); ctx.moveTo(p.px,p.py); ctx.lineTo(p.x,p.y); ctx.stroke();
      if(p.sparkle && (p.age|0)%80<40){ ctx.globalAlpha=Math.max(a,.28); ctx.beginPath(); ctx.arc(p.x,p.y,p.size*.9,0,Math.PI*2); ctx.fill(); } } }
    ctx.globalAlpha=1; if(alive) requestAnimationFrame(tick); else card.removeChild(cvs);
  } requestAnimationFrame(tick);
}

/* ===== Pilot cards (template) — show immediately (no reveal) ===== */
function cardTemplate(p){
  const el=document.createElement('article'); el.className='card glass';
  el.innerHTML=`
    <div class="card-header" title="Celebrate 🎉">
      <div class="badge">#${p.number}</div>
      <div class="media">
        <img class="avatar" src="${p.avatar}" alt="${p.name}">
        <img class="helmet" src="${HELMET_ICON_SRC}" alt="Pilot Helmet" onerror="this.style.display='none'">
      </div>
      <div class="info"><h3>${p.name}</h3><div class="role">Pilot — Enso</div></div>
    </div>
    <div class="card-info">
      <div><strong>Status:</strong> ${p.info.status} &nbsp;•&nbsp; <strong>Since:</strong> ${p.info.since}</div>
      <div class="pills">${p.info.badges.map(b=>`<span class="pill ${b==="@Pilot"?'pill-pilot':''}">${b}</span>`).join('')}</div>
    </div>
    <div class="card-body">
      <a class="btn" href="https://discord.gg/enso-build" target="_blank" rel="noreferrer noopener">${iconDiscord()} Discord</a>
      <a class="btn" href="https://x.com/EnsoBuild" target="_blank" rel="noreferrer noopener">${iconX()} X</a>
    </div>`;
  el.querySelector('.card-header').addEventListener('click',(e)=>launchFireworks(el,e.clientX,e.clientY));
  return el; // ไม่ observe
}

/* ===== Pilots list + immediate render (UPDATED, deduped) ===== */
const RAW_NAMES = [
  "0xKh1n","Abdul","Alt_Coiner","Andrik",
  "bc1pBITHERUMN",
  "Cozmee","ezrmol","Falcon","Ghfri","GIAN","hanzo(φ,G)","haruya_","HASHAN",
  "JohnnyChuon…","KAIRO","kokoko","LEVIOUSA","Leyba","Lolichan","longdv","Lucky",
  "MMPR(✧✦)","Moted.Eth","Ngô Hoàng","Rutto",
  "shark_thegreat","Shubh","SOJIB","Tomiwayrn","Vkorn","Wiko",
  "NDUKAM","MONTEGO","S!LOWEK","Ric vn"
];
const NAMES = [...new Set(RAW_NAMES)];
const SAMPLE_INFO={status:"Active", since:"2023", badges:["@Pilot","@Community","@Veteran","@Nitro Sensei"]};
const DATA=NAMES.map((n,i)=>({name:n, number:i+1, avatar:initialAvatar(n), info:{...SAMPLE_INFO}}));
const grid=document.getElementById('grid');
DATA.forEach(p=>grid.appendChild(cardTemplate(p)));
</script>
</body>
</html>